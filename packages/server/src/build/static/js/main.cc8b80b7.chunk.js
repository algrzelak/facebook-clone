(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{226:function(e,t,n){e.exports=n(252)},252:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(27),c=n.n(i),o=n(188),u=n(17),l=n(8);function s(){var e=Object(u.a)(["\n  fragment PostPreview on Post {\n    id\n    content\n    createdAt\n    likesInfo {\n      isLiked\n      likes\n    }\n    commentsInfo {\n      comments\n    }\n  }\n"]);return s=function(){return e},e}function d(){var e=Object(u.a)(["\n  fragment UserPreview on User {\n    id\n    fullName\n    avatar\n  }\n"]);return d=function(){return e},e}var m=Object(l.a)(d()),f=Object(l.a)(s());function p(){var e=Object(u.a)(["\n  query User($id: String!) {\n    user(id: $id) {\n      background\n      ...UserPreview\n      friends {\n        ...UserPreview\n      }\n      friendshipStatus\n    }\n  }\n  ","\n"]);return p=function(){return e},e}function b(){var e=Object(u.a)(["\n  query Friends($userId: String!) {\n    friends(userId: $userId) {\n      ...UserPreview\n      commonFriends {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function v(){var e=Object(u.a)(["\n  query FriendRequests {\n    friendRequests {\n      id\n      sentTime\n      fromUser {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function h(){var e=Object(u.a)(["\n  query Users($input: UsersInput!) {\n    users(input: $input) {\n      ...UserPreview\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function g(){var e=Object(u.a)(["\n  query Comments($postId: String!) {\n    comments(postId: $postId) {\n      id\n      content\n      createdAt\n      user {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n"]);return g=function(){return e},e}function E(){var e=Object(u.a)(["\n  query ProfileFeed($id: ID!) {\n    profileFeed(id: $id) {\n      ...PostPreview\n    }\n  }\n  ","\n"]);return E=function(){return e},e}function O(){var e=Object(u.a)(["\n  query Posts($cursor: Float, $userId: String) {\n    posts(cursor: $cursor, userId: $userId) {\n      edges {\n        ...PostPreview\n        user {\n          ...UserPreview\n        }\n      }\n      pageInfo {\n        hasNextPage\n        endCursor\n      }\n    }\n  }\n  ","\n  ","\n"]);return O=function(){return e},e}function j(){var e=Object(u.a)(["\n  query IsPostLiked($postId: String!) {\n    isPostLiked(postId: $postId)\n  }\n"]);return j=function(){return e},e}function y(){var e=Object(u.a)(["\n  query Chats {\n    chats {\n      id\n      users {\n        ...UserPreview\n      }\n      lastMessage {\n        id\n        sentTime\n        content\n      }\n      unread\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function I(){var e=Object(u.a)(["\n  query Chat($id: String!) {\n    chat(id: $id) {\n      id\n      messages {\n        id\n        content\n        sentTime\n        user {\n          ...UserPreview\n        }\n      }\n      users {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n"]);return I=function(){return e},e}function w(){var e=Object(u.a)(["\n  query Notifications {\n    notifications {\n      id\n      user {\n        ...UserPreview\n      }\n      postId\n      type\n      receivedAt\n    }\n  }\n  ","\n"]);return w=function(){return e},e}function k(){var e=Object(u.a)(["\n  query Me {\n    me {\n      ...UserPreview\n    }\n  }\n  ","\n"]);return k=function(){return e},e}var C=Object(l.a)(k(),m),q=Object(l.a)(w(),m),S=Object(l.a)(I(),m),x=Object(l.a)(y(),m),N=(Object(l.a)(j()),Object(l.a)(O(),m,f)),R=(Object(l.a)(E(),f),Object(l.a)(g(),m)),Q=Object(l.a)(h(),m),P=Object(l.a)(v(),m),U=(Object(l.a)(b(),m),Object(l.a)(p(),m)),$=n(12),L=n(37),D=(n(235),n(308));var M=function(e){var t=Object.assign({},e),n=Object(L.c)(t),a=Object($.a)(n,2),i=a[0],c=a[1],o=c.error,u=c.touched;console.log(i);var l=o&&u;return r.a.createElement(D.a,Object.assign({fullWidth:!0,margin:"normal",variant:"outlined",id:t.name,autoComplete:"date",type:"date",error:l,helperText:l?o:""},t,i))},F=n(18),A=n.n(F),V=n(6),T=n(160),z=n(28),W=n(183),B=n(189),_=n(61);function G(){var e=Object(u.a)(["\n  mutation DeletePost($id: String!) {\n    deletePost(id: $id)\n  }\n"]);return G=function(){return e},e}function Y(){var e=Object(u.a)(["\n  mutation UpdateBackground($file: Upload!) {\n    updateBackground(file: $file)\n  }\n"]);return Y=function(){return e},e}function H(){var e=Object(u.a)(["\n  mutation UpdateAvatar($file: Upload!) {\n    updateAvatar(file: $file)\n  }\n"]);return H=function(){return e},e}function J(){var e=Object(u.a)(["\n  mutation CancelRequest($userId: String!) {\n    cancelRequest(userId: $userId)\n  }\n"]);return J=function(){return e},e}function K(){var e=Object(u.a)(["\n  mutation Unfriend($userId: String!) {\n    unfriend(userId: $userId)\n  }\n"]);return K=function(){return e},e}function X(){var e=Object(u.a)(["\n  mutation RejectRequest($userId: String!) {\n    rejectRequest(userId: $userId)\n  }\n"]);return X=function(){return e},e}function Z(){var e=Object(u.a)(["\n  mutation SendRequest($userId: String!) {\n    sendRequest(userId: $userId)\n  }\n"]);return Z=function(){return e},e}function ee(){var e=Object(u.a)(["\n  mutation AcceptRequest($userId: String!) {\n    acceptRequest(userId: $userId)\n  }\n"]);return ee=function(){return e},e}function te(){var e=Object(u.a)(["\n  mutation CreatePost($input: CreatePostInput!) {\n    createPost(input: $input) {\n      ...PostPreview\n      user {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n  ","\n"]);return te=function(){return e},e}function ne(){var e=Object(u.a)(["\n  mutation SignOut {\n    signOut\n  }\n"]);return ne=function(){return e},e}function ae(){var e=Object(u.a)(["\n  mutation SignIn($input: SignInInput!) {\n    signIn(input: $input) {\n      ...UserPreview\n    }\n  }\n  ","\n"]);return ae=function(){return e},e}function re(){var e=Object(u.a)(["\n  mutation SignUp($input: SignUpInput!) {\n    signUp(input: $input) {\n      ...UserPreview\n    }\n  }\n  ","\n"]);return re=function(){return e},e}function ie(){var e=Object(u.a)(["\n  mutation UnlikePost($postId: String!) {\n    unlikePost(postId: $postId)\n  }\n"]);return ie=function(){return e},e}function ce(){var e=Object(u.a)(["\n  mutation LikePost($postId: String!) {\n    likePost(postId: $postId)\n  }\n"]);return ce=function(){return e},e}function oe(){var e=Object(u.a)(["\n  mutation CreateComment($input: CreateCommentInput!, $postId: String!) {\n    createComment(input: $input, postId: $postId) {\n      id\n      content\n      createdAt\n    }\n  }\n"]);return oe=function(){return e},e}function ue(){var e=Object(u.a)(["\n  mutation CreateMessage($input: CreateMessageInput!, $chatId: String!) {\n    createMessage(input: $input, chatId: $chatId) {\n      id\n      content\n    }\n  }\n"]);return ue=function(){return e},e}function le(){var e=Object(u.a)(["\n  mutation DeleteComment($id: String!) {\n    deleteComment(id: $id)\n  }\n"]);return le=function(){return e},e}function se(){var e=Object(u.a)(["\n  mutation CreateChat($userId: String!) {\n    createChat(userId: $userId) {\n      id\n    }\n  }\n"]);return se=function(){return e},e}var de=Object(l.a)(se()),me=Object(l.a)(le()),fe=Object(l.a)(ue()),pe=Object(l.a)(oe()),be=Object(l.a)(ce()),ve=Object(l.a)(ie()),he=Object(l.a)(re(),m),ge=Object(l.a)(ae(),m),Ee=Object(l.a)(ne()),Oe=Object(l.a)(te(),f,m),je=Object(l.a)(ee()),ye=Object(l.a)(Z()),Ie=Object(l.a)(X()),we=Object(l.a)(K()),ke=Object(l.a)(J()),Ce=Object(l.a)(H()),qe=Object(l.a)(Y()),Se=Object(l.a)(G()),xe=n(295),Ne=n(296),Re=n(297);var Qe=function(e){var t=e.name,n=e.type,a=(e.variant,Object(T.a)(e,["name","type","variant"])),i=Object(L.c)({name:t,type:n}),c=Object($.a)(i,2),o=c[0],u=c[1],l=u.error,s=u.touched,d=l&&s;return r.a.createElement(D.a,Object.assign({fullWidth:!0,margin:"normal",variant:"outlined",id:t,autoComplete:n,type:n,error:d,helperText:d?l:""},o,a))},Pe=n(133),Ue=n(294),$e=Object(Ue.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var Le=function(e){var t=e.setVisible,n=$e(),a=function(){var e=Object(W.a)(),t=Object(B.a)(he,{onError:function(e){console.log(e.graphQLErrors[0].message)},update:function(e,t){var n=t.data;(null===n||void 0===n?void 0:n.signUp)&&e.writeQuery({query:C,data:{me:n.signUp}})}}),n=Object($.a)(t,1)[0];function a(){return(a=Object(z.a)(A.a.mark((function t(a){var r,i;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.passwordConfirm,r=a.birthday,i=Object(T.a)(a,["passwordConfirm","birthday"]),t.next=3,n({variables:{input:Object(V.a)(Object(V.a)({},i),{},{birthday:new Date(r)})}});case 3:return t.next=5,e.resetStore();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{handleSubmit:function(e){return a.apply(this,arguments)},initialValues:{firstName:"",lastName:"",email:"",password:"",passwordConfirm:"",birthday:"2000-01-01"},validationSchema:_.a().shape({})}}(),i=a.handleSubmit,c=a.initialValues,o=a.validationSchema;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe.a,{component:"h1",variant:"h5"},"Sign Up"),r.a.createElement(L.b,{initialValues:c,onSubmit:i,validationSchema:o},(function(e){var a=e.isSubmitting;return r.a.createElement(L.a,{noValidate:!0,className:n.form},r.a.createElement(Qe,{name:"firstName",type:"text",label:"First name",autoFocus:!0}),r.a.createElement(Qe,{name:"lastName",type:"text",label:"Last name"}),r.a.createElement(Qe,{name:"email",type:"email",label:"Email address"}),r.a.createElement(Qe,{name:"password",type:"password",label:"Password"}),r.a.createElement(Qe,{name:"passwordConfirm",type:"password",label:"Confirm password"}),r.a.createElement(M,{name:"birthday"}),r.a.createElement(xe.a,{variant:"contained",color:"primary",type:"submit",disabled:a,className:n.submit,fullWidth:!0},"Sign Up"),r.a.createElement(Ne.a,{container:!0,justify:"flex-end"},r.a.createElement(Ne.a,{item:!0},r.a.createElement(Re.a,{variant:"body2",href:"#",onClick:function(){return t(!1)}},"Already have an account? Sign In"))))})))},De=Object(Ue.a)((function(e){return{form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));var Me=function(e){var t=e.setVisible,n=De(),a=function(){var e=Object(B.a)(ge,{onError:function(e){console.log(e.graphQLErrors[0].message)},update:function(e,t){var n=t.data;(null===n||void 0===n?void 0:n.signIn)&&e.writeQuery({query:C,data:{me:n.signIn}})}}),t=Object($.a)(e,1)[0];function n(){return(n=Object(z.a)(A.a.mark((function e(n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t({variables:{input:n}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleSubmit:function(e){return n.apply(this,arguments)},initialValues:{email:"",password:""},validationSchema:_.a().shape({})}}(),i=a.handleSubmit,c=a.initialValues,o=a.validationSchema;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe.a,{component:"h1",variant:"h5"},"Sign In"),r.a.createElement(L.b,{initialValues:c,onSubmit:i,validationSchema:o},(function(e){var a=e.isSubmitting;return r.a.createElement(L.a,{noValidate:!0,className:n.form},r.a.createElement(Qe,{name:"email",type:"email",label:"Email address",autoFocus:!0}),r.a.createElement(Qe,{name:"password",type:"password",label:"Password"}),r.a.createElement(xe.a,{variant:"contained",size:"large",color:"primary",type:"submit",fullWidth:!0,className:n.submit,disabled:a},"Sign In"),r.a.createElement(Ne.a,{container:!0},r.a.createElement(Ne.a,{item:!0,xs:!0},r.a.createElement(Re.a,{variant:"body2",href:"#",onClick:function(){return i({email:"demo@demo.demo",password:"Demo1234"})}},"Too busy? Demo sign in")),r.a.createElement(Ne.a,{item:!0},r.a.createElement(Re.a,{variant:"body2",href:"#",onClick:function(){return t(!0)}},"Don't have an account? Sign Up"))))})))},Fe=n(298),Ae=n(311),Ve=n(199),Te=n.n(Ve),ze=Object(Ue.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main}}}));var We=function(){var e=Object(a.useState)(!1),t=Object($.a)(e,2),n=t[0],i=t[1],c=ze();return r.a.createElement(Fe.a,{component:"main",maxWidth:"sm"},r.a.createElement("div",{className:c.paper},r.a.createElement(Ae.a,{className:c.avatar},r.a.createElement(Te.a,null)),n?r.a.createElement(Le,{setVisible:i}):r.a.createElement(Me,{setVisible:i})))},Be=n(312),_e=n(66),Ge=function(){return Object(W.a)().readQuery({query:C}).me};var Ye=n(7),He=n(255),Je=Object(Ye.a)((function(e){return{root:{maxWidth:500,margin:"".concat(e.spacing(1),"px auto"),padding:e.spacing(2)}}}))(He.a),Ke=n(20),Xe=Object(Ue.a)((function(e){return Object(Be.a)({wrapper:{width:"100%",display:"flex",alignItems:"center"},form:{width:"100%"},avatar:{margin:e.spacing(0,2,0,1)},flex:{display:"flex",alignItems:"center"},button:{margin:e.spacing(2,0,1)}})}));var Ze=function(){var e=Xe(),t=Ge(),n=function(){var e=Ge(),t=e.id,n=e.fullName,a=e.avatar,r=Object(B.a)(Oe),i=Object($.a)(r,1)[0];return{handleCreatePost:function(e,r){var c=r.resetForm;return i({variables:{input:e},optimisticResponse:{createPost:{user:{id:t,fullName:n,avatar:a},likesInfo:{likes:0,isLiked:!1},commentsInfo:{comments:0},content:e.content,createdAt:new Date,id:(99999*Math.random()).toString()}},update:function(e,n){var a=n.data,r=e.readQuery({query:N}).posts;if(null===a||void 0===a?void 0:a.createPost){e.writeQuery({query:N,data:{posts:Object(V.a)(Object(V.a)({},r),{},{edges:[i].concat(Object(_e.a)(r.edges))})}});try{var o=e.readQuery({query:N,variables:{userId:t}}).posts;e.writeQuery({query:N,variables:{userId:t},data:{posts:Object(V.a)(Object(V.a)({},o),{},{edges:[i].concat(Object(_e.a)(o.edges))})}})}catch(u){}}c()}})},initialValues:{content:""},validationSchema:_.a().shape({})}}(),a=n.handleCreatePost,i=n.initialValues,c=n.validationSchema;return r.a.createElement(Je,null,r.a.createElement("div",{className:e.wrapper},r.a.createElement(L.b,{initialValues:i,onSubmit:a,validationSchema:c},(function(){return r.a.createElement(L.a,{noValidate:!0,className:e.form},r.a.createElement("div",{className:e.flex},r.a.createElement(Ke.b,{to:"/users/".concat(t.id)},r.a.createElement(Ae.a,{src:t.avatar,alt:t.fullName,className:e.avatar})),r.a.createElement(Qe,{type:"text",name:"content",rows:2,multiline:!0,placeholder:"What's on your mind, ".concat(t.fullName,"?"),autoComplete:"off",margin:"none"})),r.a.createElement(xe.a,{variant:"contained",type:"submit",fullWidth:!0,className:e.button},"Post"))}))))},et=n(303),tt=n(55),nt=n.n(tt),at=n(299),rt=n(217),it=n(300),ct=n(200),ot=n.n(ct),ut=n(15);function lt(e){var t=e.name,n=Object(a.useState)(null),r=Object($.a)(n,2),i=r[0],c=r[1],o=Boolean(i);return{handleClick:function(e){c(e.currentTarget)},handleClose:function(){c(null)},open:o,id:o?t:void 0,anchorEl:i}}var st=function(e){var t=function(e){var t=e.id,n=Object(B.a)(Se,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0],r=Object(ut.h)().id;return{handleDeletePost:function(){return a({variables:{id:t},optimisticResponse:{deletePost:!0},update:function(e){var n=r&&{variables:{userId:r}},a=e.readQuery(Object(V.a)({query:N},n)).posts;e.writeQuery(Object(V.a)(Object(V.a)({query:N},n),{},{data:{posts:Object(V.a)(Object(V.a)({},a),{},{edges:a.edges.filter((function(e){return e.id!==t}))})}}))}})}}}({id:e.id}).handleDeletePost,n=lt({name:"menu"}),a=n.id,i=n.handleClick,c=n.handleClose,o=n.open,u=n.anchorEl;return r.a.createElement("div",null,r.a.createElement(at.a,{"aria-label":"settings","aria-controls":"menu","aria-haspopup":"true",onClick:i},r.a.createElement(ot.a,null)),r.a.createElement(rt.a,{id:a,anchorEl:u,keepMounted:!0,open:o,onClose:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement(it.a,{onClick:t},"Delete")))};function dt(e){var t=e.postId;return{handleLike:function(e){var t=e.postId,n=Object(ut.h)().id,a=Object(B.a)(be,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),r=Object($.a)(a,1)[0];function i(){return(i=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r({variables:{postId:t},optimisticResponse:{like:!0},update:function(e){var a=n&&{variables:{userId:n}},r=e.readQuery(Object(V.a)({query:N},a)).posts,i=r.edges.find((function(e){return e.id===t}));if(i){var c=i.likesInfo,o=Object(V.a)(Object(V.a)({},i),{},{likesInfo:Object(V.a)(Object(V.a)({},c),{},{likes:c.likes+1,isLiked:!0})});e.writeQuery(Object(V.a)(Object(V.a)({query:N},a),{},{data:{posts:Object(V.a)(Object(V.a)({},r),{},{edges:r.edges.map((function(e){return e.id===t?o:e}))})}}))}}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleLike:function(){return i.apply(this,arguments)}}}({postId:t}).handleLike,handleUnlike:function(e){var t=e.postId,n=Object(ut.h)().id,a=Object(B.a)(ve,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),r=Object($.a)(a,1)[0];function i(){return(i=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r({variables:{postId:t},optimisticResponse:{unlike:!0},update:function(e){var a=n&&{variables:{userId:n}},r=e.readQuery(Object(V.a)({query:N},a)).posts,i=r.edges.find((function(e){return e.id===t}));if(i){var c=i.likesInfo,o=Object(V.a)(Object(V.a)({},i),{},{likesInfo:Object(V.a)(Object(V.a)({},c),{},{likes:c.likes-1,isLiked:!1})});e.writeQuery(Object(V.a)(Object(V.a)({query:N},a),{},{data:{posts:Object(V.a)(Object(V.a)({},r),{},{edges:r.edges.map((function(e){return e.id===t?o:e}))})}}))}}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleUnlike:function(){return i.apply(this,arguments)}}}({postId:t}).handleUnlike}}var mt=n(201),ft=n.n(mt);function pt(e){var t=e.handleClick;return r.a.createElement(at.a,{onClick:t},r.a.createElement(ft.a,null))}var bt=n(202),vt=n.n(bt);function ht(e){var t=e.handleClick;return r.a.createElement(at.a,{onClick:t},r.a.createElement(vt.a,null))}function gt(e){var t=e.likesInfo,n=dt({postId:e.postId}),a=n.handleLike,i=n.handleUnlike,c=t.isLiked,o=t.likes;return r.a.createElement("div",null,c?r.a.createElement(ht,{handleClick:i}):r.a.createElement(pt,{handleClick:a}),r.a.createElement(Pe.a,null,o))}var Et=n(203),Ot=n.n(Et);function jt(e){var t=e.commentsInfo,n=e.toggleComments;return r.a.createElement("div",null,r.a.createElement(at.a,{onClick:n},r.a.createElement(Ot.a,null)),r.a.createElement(Pe.a,null,t.comments))}var yt=n(293),It=n(256),wt=n(301),kt=n(302);function Ct(e){return((new Date).getTime()-new Date(e).getTime())/864e5<1?"HH:mm":"DD/MM/YYYY"}var qt=n(204),St=n.n(qt);function xt(e){var t=function(e){var t=e.commentId,n=e.postId,a=Object(B.a)(me),r=Object($.a)(a,1)[0];return{handleDeleteComment:function(){return r({variables:{id:t},update:function(e){var a=e.readQuery({query:R,variables:{postId:n}}).comments;e.writeQuery({query:R,variables:{postId:n},data:{comments:a.filter((function(e){return e.id!==t}))}});var r=e.readQuery({query:N}).posts,i=r.edges.find((function(e){return e.id===n}));if(i){var c=i.commentsInfo,o=Object(V.a)(Object(V.a)({},i),{},{commentsInfo:Object(V.a)(Object(V.a)({},c),{},{comments:c.comments-1})});e.writeQuery({query:N,data:{posts:Object(V.a)(Object(V.a)({},r),{},{edges:r.edges.map((function(e){return e.id===n?o:e}))})}})}}})}}}({commentId:e.commentId,postId:e.postId}).handleDeleteComment;return r.a.createElement("div",null,r.a.createElement(at.a,{onClick:t},r.a.createElement(St.a,null)))}var Nt=Object(Ue.a)((function(){return{link:{fontWeight:"bold",textDecoration:"none",color:"inherit"},date:{display:"flex",justifyContent:"center"}}}));function Rt(e){var t=e.comment,n=e.postId,a=Nt(),i=Ge(),c=t.id,o=t.user,u=t.content,l=t.createdAt;return r.a.createElement(It.a,null,r.a.createElement(wt.a,null,r.a.createElement(Ke.b,{to:"/users/".concat(o.id),className:a.link},r.a.createElement(Ae.a,{src:o.avatar}))),r.a.createElement(kt.a,{primary:r.a.createElement(r.a.Fragment,null,r.a.createElement(Pe.a,{variant:"subtitle1",className:a.link,component:Ke.b,to:"/users/".concat(o.id)},o.fullName),r.a.createElement(Pe.a,{variant:"subtitle2"},u))}),r.a.createElement(Pe.a,{variant:"caption",gutterBottom:!0},r.a.createElement("div",{className:a.date},r.a.createElement(nt.a,{format:Ct(l),date:l})),i.id===o.id&&r.a.createElement(xt,{commentId:c,postId:n})))}function Qt(e){var t=e.comments,n=e.postId;return t?r.a.createElement(yt.a,null,t.map((function(e){return r.a.createElement(Rt,{comment:e,key:e.id,postId:n})}))):r.a.createElement(et.a,null)}function Pt(e){var t=function(e){var t=e.postId,n=Object(ut.h)().id,a=Object(B.a)(pe),r=Object($.a)(a,1)[0];return{handleCreateComment:function(e,a){var i=a.resetForm;return r({variables:{input:e,postId:t},update:function(e,a){var r=a.data,c=e.readQuery({query:R,variables:{postId:t}}).comments;if(r){e.writeQuery({query:R,variables:{postId:t},data:{comments:[].concat(Object(_e.a)(c),[r.createComment])}});var o=n&&{variables:{userId:n}},u=e.readQuery(Object(V.a)({query:N},o)).posts,l=u.edges.find((function(e){return e.id===t}));if(l){var s=l.commentsInfo,d=Object(V.a)(Object(V.a)({},l),{},{commentsInfo:Object(V.a)(Object(V.a)({},s),{},{comments:s.comments+1})});e.writeQuery(Object(V.a)(Object(V.a)({query:N},o),{},{data:{posts:Object(V.a)(Object(V.a)({},u),{},{edges:u.edges.map((function(e){return e.id===t?d:e}))})}}))}}i()}})},initialValues:{content:""},validationSchema:_.a().shape({})}}({postId:e.postId}),n=t.handleCreateComment,a=t.initialValues,i=t.validationSchema;return r.a.createElement(L.b,{initialValues:a,onSubmit:n,validationSchema:i},(function(){return r.a.createElement(L.a,{noValidate:!0},r.a.createElement("div",null,r.a.createElement(Qe,{type:"text",name:"content",autoComplete:"off",margin:"none"})),r.a.createElement(xe.a,{variant:"contained",type:"submit",fullWidth:!0},"Comment"))}))}function Ut(e){var t=e.postId,n=function(e){var t=e.postId,n=Object(o.a)(R,{variables:{postId:t},onError:function(e){console.log(e.graphQLErrors[0].message)}}).data;return null===n||void 0===n?void 0:n.comments}({postId:t});return r.a.createElement("div",null,r.a.createElement(Qt,{comments:n,postId:t}),r.a.createElement(Pt,{postId:t}))}var $t=Object(Ue.a)((function(e){return{header:{display:"flex",justifyContent:"space-between",margin:e.spacing(0,0,3)},link:{textDecoration:"none",fontWeight:"bold","&:visited":{color:"inherit"}},flex:{display:"flex"},postInfo:{marginLeft:e.spacing(1)},actions:{display:"flex","& > *":{display:"flex",justifyContent:"center",alignItems:"center"}}}}));var Lt=function(e){var t=e.post,n=$t(),i=Ge(),c=function(){var e=Object(a.useState)(!1),t=Object($.a)(e,2),n=t[0],r=t[1];return{toggleComments:function(){r(!n)},isCommentsVisible:n}}(),o=c.isCommentsVisible,u=c.toggleComments,l=t.user;return r.a.createElement(Je,null,r.a.createElement("div",{className:n.header},r.a.createElement("div",{className:n.flex},r.a.createElement(Ke.b,{to:"/users/".concat(l.id)},r.a.createElement(Ae.a,{src:l.avatar,alt:l.fullName})),r.a.createElement("div",{className:n.postInfo},r.a.createElement(Pe.a,{className:n.link,variant:"subtitle1",component:Ke.b,to:"/users/".concat(l.id)},l.fullName),r.a.createElement(Pe.a,{variant:"subtitle2"},r.a.createElement(nt.a,{fromNow:!0,date:t.createdAt})))),i.id===l.id&&r.a.createElement(st,{id:t.id})),r.a.createElement("div",null,r.a.createElement(Pe.a,null,t.content)),r.a.createElement("div",{className:n.actions},r.a.createElement(gt,{postId:t.id,likesInfo:t.likesInfo}),r.a.createElement(jt,{postId:t.id,commentsInfo:t.commentsInfo,toggleComments:u})),o&&r.a.createElement(Ut,{postId:t.id}))},Dt=n(205),Mt=n.n(Dt),Ft=Object(Ue.a)((function(e){return{root:{flexGrow:1,overflow:"hidden",padding:e.spacing(0,3)}}}));var At=function(){var e=Ft(),t=Object(o.a)(N,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),n=t.data,a=t.fetchMore;if(!(null===n||void 0===n?void 0:n.posts))return r.a.createElement(et.a,null);var i=n.posts,c=i.edges,u=i.pageInfo,l=u.hasNextPage,s=u.endCursor;function d(){return(d=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({query:N,variables:{cursor:s},updateQuery:function(e,t){var n=t.fetchMoreResult;if(!n)return e;var a=n.posts,r=a.edges,i=a.pageInfo,c=a.__typename,o=e.posts.edges;return{posts:{__typename:c,edges:[].concat(Object(_e.a)(o),Object(_e.a)(r)),pageInfo:i}}}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",{className:e.root},r.a.createElement(Mt.a,{pageStart:0,loadMore:function(){return d.apply(this,arguments)},hasMore:l,loader:r.a.createElement("div",{key:s},"Loading...")},c.map((function(e){return r.a.createElement(Lt,{post:e,key:e.id,user:e.user})}))))},Vt=Object(Ue.a)((function(){return Object(Be.a)({root:{}})}));var Tt=function(){var e=Vt();return r.a.createElement(Fe.a,{component:"main",maxWidth:"sm",className:e.root},r.a.createElement(Ze,null),r.a.createElement(At,null))},zt=n(132),Wt=n(206),Bt=n.n(Wt);function _t(){var e=function(){var e=Object(W.a)(),t=Object(B.a)(Ee,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),n=Object($.a)(t,1)[0],a=Object(ut.g)();function r(){return(r=Object(z.a)(A.a.mark((function t(){return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a("/"),t.next=3,n();case 3:return t.next=5,e.resetStore();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{handleSignOut:function(){return r.apply(this,arguments)}}}().handleSignOut;return r.a.createElement(at.a,{onClick:e,color:"inherit"},r.a.createElement(Bt.a,{fontSize:"large"}))}var Gt=n(23),Yt=n(305),Ht=n(306),Jt=n(211),Kt=n.n(Jt),Xt=n(212),Zt=n.n(Xt),en=n(310),tn=Object(Ue.a)((function(e){return Object(Be.a)({wrapper:{maxWidth:"400px",width:"100%"}})}));var nn=function(){var e=tn(),t=Object(a.useState)(""),n=Object($.a)(t,2),i=n[0],c=n[1],u=Object(o.a)(Q,{variables:{input:{filter:i}},notifyOnNetworkStatusChange:!0}),l=u.data,s=u.loading,d=Object(a.useState)(!1),m=Object($.a)(d,2),f=m[0],p=m[1],b=Object(ut.g)();return r.a.createElement(en.a,{className:e.wrapper,id:"search-autocomplete",open:f,onOpen:function(){return p(!0)},onClose:function(){return p(!1)},getOptionSelected:function(e,t){return e.fullName===t.fullName},getOptionLabel:function(e){return e.fullName},options:(null===l||void 0===l?void 0:l.users)||[],loading:s,onChange:function(e,t){return t&&b("/users/".concat(null===t||void 0===t?void 0:t.id))},noOptionsText:"User not found",renderInput:function(e){return r.a.createElement(D.a,Object.assign({},e,{value:i,onChange:function(e){return c(e.target.value)},variant:"outlined",fullWidth:!0,autoFocus:!0,style:{backgroundColor:"white"},placeholder:"Search someone",autoComplete:"off",InputProps:Object(V.a)(Object(V.a)({},e.InputProps),{},{endAdornment:r.a.createElement(r.a.Fragment,null,s?r.a.createElement(et.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))}})},an=n(304),rn=n(309),cn=n(208),on=n.n(cn);function un(e){var t=e.userId,n=Object(B.a)(je,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];function r(){return(r=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({variables:{userId:t},optimisticResponse:{acceptRequest:!0},update:function(e){var n=e.readQuery({query:P}).friendRequests;e.writeQuery({query:P,data:{friendRequests:n.filter((function(e){return e.fromUser.id!==t}))}})}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleAcceptRequest:function(){return r.apply(this,arguments)}}}var ln=function(e){var t=e.friendRequest,n=t.fromUser,a=n.avatar,i=n.fullName,c=n.id,o=t.sentTime,u=un({userId:c}).handleAcceptRequest,l=function(e){var t=e.userId,n=Object(B.a)(Ie,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];function r(){return(r=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({variables:{userId:t},optimisticResponse:{rejectRequest:!0},update:function(e){var n=e.readQuery({query:P}).friendRequests;e.writeQuery({query:P,data:{friendRequests:n.filter((function(e){return e.fromUser.id!==t}))}})}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleRejectRequest:function(){return r.apply(this,arguments)}}}({userId:c}).handleRejectRequest;return r.a.createElement(It.a,null,r.a.createElement(wt.a,null,r.a.createElement(Ae.a,{src:a,alt:"Person's avatar"})),r.a.createElement("div",null,r.a.createElement(kt.a,{primary:i,secondary:r.a.createElement(nt.a,{fromNow:!0,date:o})}),r.a.createElement("div",null,r.a.createElement(xe.a,{variant:"contained",color:"primary",onClick:u,size:"small"},"Accept"),r.a.createElement(xe.a,{variant:"contained",color:"secondary",onClick:l,size:"small"},"Reject"))))};function sn(e){var t=e.text;return r.a.createElement(yt.a,null,r.a.createElement(It.a,null,r.a.createElement(kt.a,{primary:t})))}var dn=function(e){var t=e.friendRequests;return t?0===t.length?r.a.createElement(sn,{text:"0 friend requests"}):r.a.createElement(yt.a,null,t.map((function(e){return r.a.createElement(ln,{key:e.id,friendRequest:e})}))):r.a.createElement(et.a,null)};var mn=Object(Ue.a)((function(e){return Object(Be.a)({root:{marginLeft:e.spacing(1)}})}));var fn=function(){var e=mn(),t=function(){var e=Object(o.a)(P,{onError:function(e){console.log(e.graphQLErrors[0].message)}}).data;return null===e||void 0===e?void 0:e.friendRequests}(),n=lt({name:"friend-requests"}),a=n.handleClick,i=n.handleClose,c=n.open,u=n.anchorEl,l=n.id;return r.a.createElement("div",{className:e.root},r.a.createElement(at.a,{"aria-label":"friend request list",color:"inherit",onClick:a},r.a.createElement(an.a,{badgeContent:t?t.length:0,color:"secondary"},r.a.createElement(on.a,{fontSize:"large"}))),r.a.createElement(rn.a,{id:l,open:c,anchorEl:u,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(dn,{friendRequests:t})))},pn=n(209),bn=n.n(pn),vn=Object(Ue.a)((function(e){return{root:{width:360,backgroundColor:e.palette.background.paper},link:{textDecoration:"none",color:"inherit","& > *":{"&:hover":{backgroundColor:"#f0f0f0"}}},unreadItem:{backgroundColor:"#f6f6f6","& span":{fontWeight:"bold"},"& p":{fontWeight:"bold"}},content:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}}));function hn(e){var t=e.chats,n=vn();return t?0===t.length?r.a.createElement(sn,{text:"0 chats"}):r.a.createElement(yt.a,{className:n.root},t.map((function(e){var t=e.id,a=e.users,i=e.lastMessage,c=e.unread;return r.a.createElement(Ke.b,{to:"/chats/".concat(t),key:t,className:n.link},r.a.createElement(It.a,{className:c?n.unreadItem:""},r.a.createElement(wt.a,null,r.a.createElement(Ae.a,{src:a[0].avatar})),r.a.createElement(kt.a,{className:n.content,primary:a[0].fullName,secondary:i.content}),r.a.createElement(Pe.a,{variant:"caption",gutterBottom:!0},r.a.createElement(nt.a,{format:Ct(i.sentTime),date:i.sentTime}))))}))):r.a.createElement(et.a,null)}var gn=n(190);function En(){var e=Object(u.a)(["\n  subscription MessageReceived {\n    messageReceived {\n      id\n      content\n      chatId\n      readTime\n      sentTime\n      user {\n        ...UserPreview\n      }\n    }\n  }\n  ","\n"]);return En=function(){return e},e}var On=Object(l.a)(En(),m);function jn(){var e=function(){var e=Object(o.a)(x,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),t=e.data,n=e.client,a=(null===t||void 0===t?void 0:t.chats)||[],r=a?a.filter((function(e){return!0===e.unread})).length:0;return Object(gn.a)(On,{onSubscriptionData:function(e){var t,a=null===(t=e.subscriptionData.data)||void 0===t?void 0:t.messageReceived;if(console.log("ddd"),a){var r=n.readQuery({query:x}).chats,i=Object(V.a)(Object(V.a)({},r.find((function(e){return e.id===a.chatId}))),{},{lastMessage:a,unread:!0}),c=r.filter((function(e){return e.id!==a.chatId})),o=[i].concat(Object(_e.a)(c));n.writeQuery({query:x,data:{chats:o}})}}}),{chats:a,unreadChatsCount:r}}(),t=e.chats,n=e.unreadChatsCount,a=lt({name:"chats"}),i=a.handleClick,c=a.handleClose,u=a.open,l=a.anchorEl,s=a.id;return r.a.createElement("div",null,r.a.createElement(at.a,{"aria-label":"show chats",edge:"end",color:"inherit",onClick:i},r.a.createElement(an.a,{color:"secondary",badgeContent:n},r.a.createElement(bn.a,{fontSize:"large"}))),r.a.createElement(rn.a,{id:s,open:u,anchorEl:l,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(hn,{chats:t})))}var yn,In,wn=n(210),kn=n.n(wn);!function(e){e.Pending="PENDING",e.Friends="FRIENDS"}(yn||(yn={})),function(e){e.PostLiked="POST_LIKED",e.PostCommented="POST_COMMENTED"}(In||(In={}));var Cn=Object(Ue.a)((function(e){return Object(Be.a)({root:{width:360,backgroundColor:e.palette.background.paper}})}));function qn(e){var t=e.notification,n=Cn();return r.a.createElement(It.a,{className:n.root},r.a.createElement(wt.a,null,r.a.createElement(Ae.a,{src:t.user.avatar})),r.a.createElement(kt.a,{primary:"".concat(t.user.fullName," ").concat(t.type===In.PostLiked?"liked":"commented"," your post!"),secondary:r.a.createElement(nt.a,{fromNow:!0,date:t.receivedAt})}))}function Sn(e){var t=e.notifications;return t?0===t.length?r.a.createElement(sn,{text:"0 notifications"}):r.a.createElement(yt.a,null,t.map((function(e){return r.a.createElement(qn,{notification:e,key:e.id})}))):r.a.createElement(et.a,null)}function xn(){var e=function(){var e=Object(o.a)(q,{onError:function(e){console.log(e.graphQLErrors[0].message)}}).data;return null===e||void 0===e?void 0:e.notifications}(),t=lt({name:"notifications"}),n=t.id,a=t.open,i=t.anchorEl,c=t.handleClose,u=t.handleClick;return r.a.createElement("div",null,r.a.createElement(at.a,{"aria-label":"show chats",edge:"end",color:"inherit",onClick:u},r.a.createElement(kn.a,{fontSize:"large"})),r.a.createElement(rn.a,{id:n,open:a,anchorEl:i,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement(Sn,{notifications:e})))}var Nn=Object(Ue.a)((function(e){return Object(Be.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,textDecoration:"none"},search:Object(zt.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(Gt.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(Gt.c)(e.palette.common.white,.25)},marginLeft:0,width:"100%",maxWidth:"400px"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1)}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},rest:{display:"flex"},toolbar:{display:"flex",justifyContent:"center"},inputInput:Object(zt.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})})}));var Rn=function(){var e=Nn(),t=Object(a.useState)(!1),n=Object($.a)(t,2),i=n[0],c=n[1];return r.a.createElement("div",{className:e.root},r.a.createElement(Yt.a,{position:"static",onBlur:function(){return c(!1)}},r.a.createElement(Ht.a,{className:e.toolbar},i?r.a.createElement(nn,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(at.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"home",component:Ke.b,to:"/"},r.a.createElement(Kt.a,{fontSize:"large"})),r.a.createElement(at.a,{color:"inherit",onClick:function(){return c(!0)}},r.a.createElement(Zt.a,{fontSize:"large"})),r.a.createElement(fn,null),r.a.createElement(jn,null),r.a.createElement(xn,null),r.a.createElement(_t,null)))))},Qn=Object(Ue.a)((function(){return Object(Be.a)({root:{display:"flex",width:"100%",height:200,zIndex:9999},img:{objectFit:"cover",width:"100%",height:"100%"},badge:{width:"100%",height:"100%",display:"flex"}})}));var Pn=function(e){var t=e.background,n=Qn();return r.a.createElement("div",{className:n.root},r.a.createElement("img",{src:t||"https://cdn.pixabay.com/photo/2018/07/18/19/45/brick-3547144_960_720.jpg",alt:"Your background",className:n.img}))};var Un=Object(Ue.a)((function(){return Object(Be.a)({input:{display:"none"},icon:{cursor:"pointer",color:"black"}})}));var $n=function(){var e=Un(),t=function(){var e=Object(W.a)().readQuery({query:C}).me.id,t=Object(B.a)(qe,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),n=Object($.a)(t,2),a=n[0];return{handleUpdateBackground:function(t){var n=t.target,r=n.validity,i=n.files;if(!i)throw new Error("Invalid input");var c=i[0];return r.valid&&a({variables:{file:c},update:function(t,n){var a=n.data,r=t.readQuery({query:U,variables:{id:e}}).user;t.writeQuery({query:U,variables:{id:e},data:{user:Object(V.a)(Object(V.a)({},r),{},{background:null===a||void 0===a?void 0:a.updateBackground})}})}})},loading:n[1].loading}}(),n=t.handleUpdateBackground,a=t.loading;return r.a.createElement("div",null,r.a.createElement("input",{id:"background-upload",accept:"image/*",type:"file",onChange:n,className:e.input}),r.a.createElement("label",{htmlFor:"background-upload"},r.a.createElement(xe.a,{variant:"contained",component:"span",disabled:a},"Edit background")))};var Ln,Dn=Object(Ue.a)((function(e){return Object(Be.a)({root:{display:"flex"}})}));function Mn(){var e=Dn(),t=function(e){var t=e.userId,n=Object(ut.g)(),a=Object(B.a)(de,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),r=Object($.a)(a,1)[0];function i(){return(i=Object(z.a)(A.a.mark((function e(){var a,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({variables:{userId:t},update:function(e,t){var n=t.data;console.log(n)}});case 2:i=e.sent,n("/chats/".concat(null===(a=i.data)||void 0===a?void 0:a.createChat.id));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleCreateChat:function(){return i.apply(this,arguments)}}}({userId:Object(ut.h)().id}).handleCreateChat;return r.a.createElement("div",{className:e.root},r.a.createElement(xe.a,{variant:"contained",onClick:t},"Message"))}!function(e){e.Stranger="STRANGER",e.Friend="FRIEND",e.MeSentRequest="ME_SENT_REQUEST",e.MeReceivedRequest="ME_RECEIVED_REQUEST"}(Ln||(Ln={}));var Fn=function(e){var t=e.userId;return{handleSendRequest:function(e){var t=e.userId,n=Object(B.a)(ye,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];function r(){return(r=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({variables:{userId:t},optimisticResponse:{sendRequest:!0},update:function(e){var n=e.readQuery({query:U,variables:{id:t}}).user;e.writeQuery({query:U,variables:{id:t},data:{user:Object(V.a)(Object(V.a)({},n),{},{friendshipStatus:Ln.MeSentRequest})}})}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleSendRequest:function(){return r.apply(this,arguments)}}}({userId:t}).handleSendRequest,handleUnfriend:function(e){var t=e.userId,n=Object(B.a)(we,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];function r(){return(r=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({variables:{userId:t},update:function(e){var n=e.readQuery({query:U,variables:{id:t}}).user;e.writeQuery({query:U,variables:{userId:t},data:{user:Object(V.a)(Object(V.a)({},n),{},{friendshipStatus:Ln.Stranger})}})}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleUnfriend:function(){return r.apply(this,arguments)}}}({userId:t}).handleUnfriend,handleCancelRequest:function(e){var t=e.userId,n=Object(B.a)(ke,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];function r(){return(r=Object(z.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a({variables:{userId:t},optimisticResponse:{cancelRequest:!0},update:function(e){var n=e.readQuery({query:U,variables:{id:t}}).user;e.writeQuery({query:U,variables:{id:t},data:{user:Object(V.a)(Object(V.a)({},n),{},{friendshipStatus:Ln.Stranger})}})}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleCancelRequest:function(){return r.apply(this,arguments)}}}({userId:t}).handleCancelRequest,handleAcceptRequest:un({userId:t}).handleAcceptRequest}};var An=function(){var e,t,n=Object(ut.h)().id,a=Fn({userId:n}),i=a.handleSendRequest,c=a.handleUnfriend,o=a.handleCancelRequest,u=a.handleAcceptRequest;switch(function(e){var t=e.userId;return Object(W.a)().readQuery({query:U,variables:{id:t}}).user.friendshipStatus}({userId:n})){case Ln.Stranger:e=i,t="Add friend";break;case Ln.Friend:e=c,t="Unfriend";break;case Ln.MeSentRequest:e=o,t="Cancel request";break;case Ln.MeReceivedRequest:e=u,t="Accept request"}return r.a.createElement(xe.a,{variant:"contained",onClick:e},t)},Vn=Object(Ue.a)((function(e){return Object(Be.a)({root:{display:"flex"}})}));function Tn(){var e=Vn(),t=Object(ut.h)().id,n=Ge().id===t;return r.a.createElement("div",{className:e.root},n?r.a.createElement($n,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(An,null),r.a.createElement(Mn,null)))}var zn=Object(Ye.a)((function(e){return{root:{border:"thick solid #f0f0f0",width:e.spacing(20),height:e.spacing(20)}}}))(Ae.a),Wn=n(213),Bn=n.n(Wn);var _n=Object(Ue.a)((function(e){return Object(Be.a)({input:{display:"none"},icon:{cursor:"pointer",color:"black"},button:{width:e.spacing(5),height:e.spacing(5),backgroundColor:"#f0f0f0",borderRadius:"50%","&:hover":{backgroundColor:"#d0d0d0"}}})}));var Gn=function(){var e=_n(),t=function(){var e=Object(B.a)(Ce,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),t=Object($.a)(e,2),n=t[0];return{handleUpdateAvatar:function(e){var t=e.target,a=t.validity,r=Object($.a)(t.files,1)[0];return a.valid&&n({variables:{file:r},update:function(e,t){var n=t.data,a=e.readQuery({query:C});e.writeQuery({query:C,data:{me:Object(V.a)(Object(V.a)({},a.me),{},{avatar:null===n||void 0===n?void 0:n.updateAvatar})}})}})},loading:t[1].loading}}(),n=t.handleUpdateAvatar;return t.loading?r.a.createElement(et.a,{className:e.button}):r.a.createElement("div",null,r.a.createElement("input",{id:"avatar-upload",accept:"image/*",type:"file",onChange:n,className:e.input}),r.a.createElement("label",{htmlFor:"avatar-upload"},r.a.createElement(at.a,{component:"span",className:e.button},r.a.createElement(Bn.a,{className:e.icon}))))},Yn=Object(Ue.a)((function(e){return Object(Be.a)({badge:{width:e.spacing(20),height:e.spacing(20)}})}));var Hn=function(e){var t=e.children,n=Yn(),a=Ge(),i=Object(ut.h)().id;return a.id===i?r.a.createElement(an.a,{overlap:"circle",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:r.a.createElement(Gn,null),className:n.badge},t):t},Jn=Object(Ue.a)((function(e){return Object(Be.a)({root:{display:"flex",justifyContent:"center",alignItems:"flex-end",alignSelf:"flex-start",width:"100%",position:"relative"},wrapper:{position:"absolute",display:"flex",justifyContent:"center","& > *":{margin:e.spacing(1)},zIndex:999}})}));function Kn(e){var t=e.avatar,n=Jn();return r.a.createElement("div",{className:n.root},r.a.createElement("div",{className:n.wrapper},r.a.createElement(Hn,null,r.a.createElement(zn,{src:t,alt:"Avatar"}))))}var Xn=Object(Ue.a)((function(e){return Object(Be.a)({root:{justifyContent:"center",width:"100%",padding:e.spacing(3),marginBottom:e.spacing(2)},grid:{borderColor:"red",borderStyle:"solid",borderWidth:"10px"},images:{display:"flex",justifyContent:"center",alignItems:"flex-end",alignSelf:"flex-start",width:"100%",position:"relative"},name:{width:"100%"},imagesWrapper:{position:"absolute",display:"flex",justifyContent:"center","& > *":{margin:e.spacing(1)},zIndex:999}})}));var Zn=function(){var e=Xn(),t=function(){var e=Object(W.a)(),t=Object(ut.h)().id;return{user:e.readQuery({query:U,variables:{id:t}}).user}}().user;return r.a.createElement("div",{className:e.root},r.a.createElement(Pn,{background:t.background}),r.a.createElement(Kn,{avatar:t.avatar}),r.a.createElement("div",{className:e.name},r.a.createElement(Pe.a,{align:"center",variant:"h2"},t.fullName)),r.a.createElement(Tn,null))};var ea=function(){var e=function(){var e=Object(ut.h)().id,t=e&&{variables:{userId:e}},n=Object(o.a)(N,Object(V.a)({onError:function(e){console.log(e.graphQLErrors[0].message)}},t)).data;return null===n||void 0===n?void 0:n.posts.edges}();return e?0===e.length?r.a.createElement(sn,{text:"0 posts"}):r.a.createElement("div",null,r.a.createElement("ul",null,e.map((function(e){return r.a.createElement(Lt,{key:e.id,post:e})})))):r.a.createElement(et.a,null)},ta=Object(Ue.a)((function(){return Object(Be.a)({link:{textDecoration:"none",color:"inherit"}})}));function na(e){var t=e.friend,n=ta();return r.a.createElement(It.a,{key:t.id},r.a.createElement(wt.a,null,r.a.createElement(Ke.b,{to:"/users/".concat(t.id)},r.a.createElement(Ae.a,{src:t.avatar,alt:"Friend's avatar"}))),r.a.createElement(Ke.b,{to:"/users/".concat(t.id),className:n.link},r.a.createElement(kt.a,{primary:t.fullName})))}var aa=function(e){var t=e.friends;return r.a.createElement("div",null,r.a.createElement(yt.a,null,t.map((function(e){return r.a.createElement(na,{friend:e,key:e.id})}))))};function ra(){var e=function(e){var t=e.id;return Object(W.a)().readQuery({query:U,variables:{id:t}}).user.friends}({id:Object(ut.h)().id});return r.a.createElement("div",null,r.a.createElement(Pe.a,{variant:"h5",align:"center"},e.length," ",1===e.length?"friend":"friends"),r.a.createElement(aa,{friends:e}))}var ia=Object(Ue.a)((function(){return Object(Be.a)({root:{flexGrow:1}})}));var ca=function(){var e=ia();return function(){var e=Object(ut.h)().id,t=Object(o.a)(U,{variables:{id:e}}),n=t.data;return{user:t.loading?null:null===n||void 0===n?void 0:n.user}}().user?r.a.createElement(Fe.a,{maxWidth:"md",component:"main",className:e.root},r.a.createElement(Zn,null),r.a.createElement(Ne.a,{container:!0,spacing:2},r.a.createElement(Ne.a,{item:!0,xs:12,sm:4,className:e.grid},r.a.createElement(ra,null)),r.a.createElement(Ne.a,{item:!0,xs:12,sm:8},r.a.createElement(ea,null)))):r.a.createElement(et.a,null)};function oa(e){var t=function(e){var t=e.chatId,n=Object(B.a)(fe,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),a=Object($.a)(n,1)[0];return{handleCreateMessage:function(e,n){var r=n.resetForm;return a({variables:{input:e,chatId:t},update:function(e,n){var a=n.data,i=e.readQuery({query:S,variables:{id:t}}).chat;a&&e.writeQuery({query:S,variables:{id:t},data:{chat:Object(V.a)(Object(V.a)({},i),{},{messages:i.messages.concat(a.createMessage)})}}),r()}})},initialValues:{content:""},validationSchema:_.a().shape({})}}({chatId:e.chatId}),n=t.handleCreateMessage,a=t.initialValues,i=t.validationSchema;return r.a.createElement(L.b,{initialValues:a,onSubmit:n,validationSchema:i},(function(){return r.a.createElement(L.a,{noValidate:!0},r.a.createElement("div",null,r.a.createElement(Qe,{type:"text",name:"content",autoComplete:"off",margin:"none"})),r.a.createElement(xe.a,{variant:"contained",type:"submit",fullWidth:!0},"Send"))}))}var ua=Object(Ue.a)((function(){return Object(Be.a)({wrap:{wordWrap:"break-word"}})}));function la(e){var t=e.message,n=ua();return r.a.createElement(It.a,{key:t.id},r.a.createElement(Ke.b,{to:"/users/".concat(t.user.id)},r.a.createElement(Ae.a,{src:t.user.avatar})),r.a.createElement(kt.a,{className:n.wrap,primary:t.content,secondary:r.a.createElement(nt.a,{fromNow:!0,date:t.sentTime})}))}function sa(e){var t=e.messages;return r.a.createElement(yt.a,null,t.map((function(e){return r.a.createElement(la,{message:e,key:e.id})})))}var da=Object(Ue.a)((function(){return Object(Be.a)({userInfo:{display:"flex",alignItems:"center",textDecoration:"none","&:visited":{color:"inherit"}}})}));function ma(e){var t=e.users,n=da();return r.a.createElement("div",null,t.map((function(e){return r.a.createElement(Ke.b,{to:"/users/".concat(e.id),className:n.userInfo,key:e.id},r.a.createElement(Ae.a,{src:e.avatar}),r.a.createElement(Pe.a,{variant:"h5"},e.fullName))})))}function fa(){var e=Object(ut.h)().id,t=function(e){var t=e.chatId,n=Object(o.a)(S,{variables:{id:t}}),a=n.data,r=n.client,i=null===a||void 0===a?void 0:a.chat;if(i){var c=r.readQuery({query:x}).chats,u=c.find((function(e){return e.id===t}));if(u){var l=Object(V.a)(Object(V.a)({},u),{},{unread:!1});r.writeQuery({query:x,data:{chats:c.map((function(e){return e.id===t?l:e}))}})}}return Object(gn.a)(On,{onSubscriptionData:function(e){var n,a=null===(n=e.subscriptionData.data)||void 0===n?void 0:n.messageReceived;console.log(a),a&&i&&r.writeQuery({query:S,variables:{id:t},data:{chat:Object(V.a)(Object(V.a)({},i),{},{messages:i.messages.concat(a)})}})}}),{chat:i}}({chatId:e}).chat;if(!t)return r.a.createElement(et.a,null);var n=t.messages,a=t.users;return r.a.createElement("div",null,r.a.createElement(ma,{users:a}),r.a.createElement(sa,{messages:n}),r.a.createElement(oa,{chatId:e}))}var pa=function(){var e=Object(o.a)(C,{onError:function(e){console.log(e.graphQLErrors[0].message)}}),t=e.data;return e.loading?null:(null===t||void 0===t?void 0:t.me)?r.a.createElement("div",null,r.a.createElement(Rn,null),r.a.createElement(ut.c,null,r.a.createElement(ut.a,{path:"/",element:r.a.createElement(Tt,null)}),r.a.createElement(ut.a,{path:"users/:id",element:r.a.createElement(ca,null)}),r.a.createElement(ut.a,{path:"chats/:id",element:r.a.createElement(fa,null)}))):r.a.createElement(We,null)},ba=n(138),va=n(139),ha=n(140),ga=n(187),Ea=n(307),Oa=n(215),ja=n(216),ya=n(214),Ia=Object(Oa.createUploadLink)({uri:"/graphql",credentials:"same-origin"}),wa=new ja.a({uri:"ws://localhost:4000/graphql",options:{reconnect:!0}}),ka=Object(ba.a)((function(e){var t=e.query,n=Object(ya.a)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),wa,Ia),Ca=new va.a({cache:new ha.a,link:ka});c.a.render(r.a.createElement(ga.a,{client:Ca},r.a.createElement(Ke.a,null,r.a.createElement(Ea.a,null),r.a.createElement(pa,null))),document.getElementById("root"))}},[[226,1,2]]]);
//# sourceMappingURL=main.cc8b80b7.chunk.js.map